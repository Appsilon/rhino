<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rhino">
<title>Tutorial: Write end-to-end tests with Cypress • rhino</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Tutorial: Write end-to-end tests with Cypress">
<meta property="og:description" content="rhino">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-NEHZJ9B11D"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NEHZJ9B11D');
</script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-FQQZL5V93G"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-FQQZL5V93G');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">rhino</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../../articles/tutorial/create-your-first-rhino-app.html">Create your first Rhino app</a>
    <a class="dropdown-item" href="../../articles/tutorial/write-end-to-end-tests-with-cypress.html">Write end-to-end tests with Cypress</a>
    <a class="dropdown-item" href="../../articles/tutorial/use-react-in-rhino.html">Use React in Rhino</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-explanation">Explanation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-explanation">
    <a class="dropdown-item" href="../../articles/explanation/what-is-rhino.html">What is Rhino?</a>
    <a class="dropdown-item" href="../../articles/explanation/application-structure.html">Application structure</a>
    <a class="dropdown-item" href="../../articles/explanation/rhino-yml.html">Configuring Rhino - rhino.yml</a>
    <a class="dropdown-item" href="../../articles/explanation/box-modules.html">Box modules</a>
    <a class="dropdown-item" href="../../articles/explanation/renv-configuration.html">Renv configuration</a>
    <a class="dropdown-item" href="../../articles/explanation/node-js-javascript-and-sass-tools.html">Node.js - JavaScript and Sass tools</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-how-to-guides">How-to Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-how-to-guides">
    <a class="dropdown-item" href="../../articles/how-to/migrate-app-to-rhino.html">Migrate app to Rhino</a>
    <a class="dropdown-item" href="../../articles/how-to/write-r-code.html">Write R code</a>
    <a class="dropdown-item" href="../../articles/how-to/write-javascript-code.html">Write JavaScript code</a>
    <a class="dropdown-item" href="../../articles/how-to/use-static-files.html">Use static files</a>
    <a class="dropdown-item" href="../../articles/how-to/manage-secrets-and-environments.html">Manage secrets and environments</a>
    <a class="dropdown-item" href="../../articles/how-to/enable-shiny-bookmarking.html">Enable Shiny bookmarking</a>
    <a class="dropdown-item" href="../../articles/how-to/keep-multiple-apps-in-a-single-repository.html">Keep multiple apps in a single repository</a>
    <a class="dropdown-item" href="../../articles/how-to/use-global-variables.html">Use global variables</a>
    <a class="dropdown-item" href="../../articles/how-to/use-shinytest2.html">Use shinytest2</a>
    <a class="dropdown-item" href="../../articles/how-to/add-internationalization.html">Add internationalization</a>
    <a class="dropdown-item" href="../../articles/how-to/add-routing.html">Add routing</a>
    <a class="dropdown-item" href="../../articles/how-to/set-application-run-parameters.html">Set application run parameters</a>
    <a class="dropdown-item" href="../../articles/how-to/use-addins.html">Use Rhino Addin(s)</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>UI</h6>
    <a class="dropdown-item" href="../../articles/how-to/use-shiny-fluent.html">Use shiny.fluent</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Authentication</h6>
    <a class="dropdown-item" href="../../articles/how-to/use-shinymanager.html">Use shinymanager</a>
    <a class="dropdown-item" href="../../articles/how-to/use-polished.html">Use polished</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Deployment</h6>
    <a class="dropdown-item" href="../../articles/how-to/publish-on-huggingface.html">Publish on Hugging Face</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../articles/faq.html">FAQ</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Appsilon/rhino/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/Appsilon">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://fosstodon.org/@appsilon">
    <span class="fab fa fab fa-mastodon fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="write-end-to-end-tests-with-cypress_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tutorial: Write end-to-end tests with Cypress</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Appsilon/rhino/blob/HEAD/vignettes/tutorial/write-end-to-end-tests-with-cypress.Rmd" class="external-link"><code>vignettes/tutorial/write-end-to-end-tests-with-cypress.Rmd</code></a></small>
      <div class="d-none name"><code>write-end-to-end-tests-with-cypress.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, we will write tests that are going to check the behavior of a running Rhino application using <a href="https://www.cypress.io/" class="external-link">Cypress</a>.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<p>Before going further, you need to install:</p>
<ol style="list-style-type: decimal">
<li>
<code>rhino</code> (surprised?) - <code>install.packages("rhino")</code>
</li>
<li>Node.js - follow <a href="https://nodejs.org/en/download/" class="external-link">instructions for your Operating System</a>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="test-application">Test application<a class="anchor" aria-label="anchor" href="#test-application"></a>
</h3>
<p>First, we need to build a simple Rhino application that is going to serve as a playground for our tests.</p>
<p>To do that, create a new project using either RStudio wizard or <code>rhino::init("EndToEndTests")</code> function. For more details, check <a href="https://appsilon.github.io/rhino/articles/tutorial/create-your-first-rhino-app.html#create-an-initial-application">Create an initial application</a> section in the basic Rhino tutorial.</p>
<p>Once you have the initial application, let’s add some content that we can test. Create two modules - <code>clicks.R</code> and <code>message.R</code> - in <code>app/view</code> directory:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/view/clicks.R</span></span>
<span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span><span class="va">actionButton</span>, <span class="va">div</span>, <span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderText</span>, <span class="va">textOutput</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu">div</span><span class="op">(</span></span>
<span>    class <span class="op">=</span> <span class="st">"clicks"</span>,</span>
<span>    <span class="fu">actionButton</span><span class="op">(</span></span>
<span>      <span class="fu">ns</span><span class="op">(</span><span class="st">"click"</span><span class="op">)</span>,</span>
<span>      <span class="st">"Click me!"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu">textOutput</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"counter"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">click</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/view/message.R</span></span>
<span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span><span class="va">actionButton</span>, <span class="va">div</span>, <span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderText</span>, <span class="va">req</span>, <span class="va">textOutput</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">div</span><span class="op">(</span></span>
<span>    class <span class="op">=</span> <span class="st">"message"</span>,</span>
<span>    <span class="fu">actionButton</span><span class="op">(</span></span>
<span>      <span class="fu">ns</span><span class="op">(</span><span class="st">"show_message"</span><span class="op">)</span>,</span>
<span>      <span class="st">"Show message"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu">textOutput</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"message_text"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">message_text</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="fu">req</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_message</span><span class="op">)</span></span>
<span></span>
<span>      <span class="st">"This is a message"</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, we need to add those modules to <code>app/main.R</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/main.R</span></span>
<span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span><span class="va">column</span>, <span class="va">fluidPage</span>, <span class="va">fluidRow</span>, <span class="va">moduleServer</span>, <span class="va">NS</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">/</span><span class="va">clicks</span>,</span>
<span>  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">/</span><span class="va">message</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu">fluidPage</span><span class="op">(</span></span>
<span>    <span class="fu">fluidRow</span><span class="op">(</span></span>
<span>      <span class="fu">column</span><span class="op">(</span></span>
<span>        width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>        <span class="va">clicks</span><span class="op">$</span><span class="fu">ui</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"clicks"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">column</span><span class="op">(</span></span>
<span>        width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>        <span class="va">message</span><span class="op">$</span><span class="fu">ui</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"message"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">clicks</span><span class="op">$</span><span class="fu">server</span><span class="op">(</span><span class="st">"clicks"</span><span class="op">)</span></span>
<span>    <span class="va">message</span><span class="op">$</span><span class="fu">server</span><span class="op">(</span><span class="st">"message"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>If you now run the application, you should see something similar to this:</p>
<p><img src="images/cypress_test_app.gif"></p>
<p>There are two functionalities that we are going to test:</p>
<ol style="list-style-type: decimal">
<li>We will check if the message is shown after clicking the button.</li>
<li>We will check if the application counts button clicks correctly.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="how-to-run-cypress-tests">How to run Cypress tests?<a class="anchor" aria-label="anchor" href="#how-to-run-cypress-tests"></a>
</h2>
<p>If you check the project structure, you will find <code>tests/cypress/</code> directory with an initial test in <code>tests/cypress/integration/app.spec.js</code> ready to use.</p>
<p>It contains a simple test that just starts the application. If your app can start, it will pass, no matter if it crashes a few seconds later.</p>
<p>Now, if you call <code><a href="../../reference/test_e2e.html">rhino::test_e2e()</a></code> the test will be run, but before that, since this is the first time you use one of the functionalities that depend on Node.js, it needs to install all the required libraries. Don’t worry, this is just a one-time step and is done automatically.</p>
<p>Once everything is installed, you will see the output of the test:</p>
<p><img src="images/basic_e2e_test.png"></p>
<p>There is one more thing worth noticing. End-to-end tests have an interactive mode, where you can see Cypress interacting with your application. To use it, simply run tests with one additional argument: <code>rhino::test_e2e(interactive = TRUE)</code> Since we have just one simple test, there will be not much there, but soon this will change.</p>
</div>
<div class="section level2">
<h2 id="test-the-message-functionality">Test the message functionality<a class="anchor" aria-label="anchor" href="#test-the-message-functionality"></a>
</h2>
<p>We are about to write our first end-to-end test. The goal is to check if clicking the button with “Show message” label will show the message.</p>
<div class="section level3">
<h3 id="test-file-structure">Test file structure<a class="anchor" aria-label="anchor" href="#test-file-structure"></a>
</h3>
<p>The first thing to do is to create a test file: <code>tests/cypress/integration/message.spec.js</code>.</p>
<p>Inside, provide a structure and description for tests using <code>describe</code> and <code>it</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/message.spec.js</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Show message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button exists"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button shows the message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>As you can see, we are going to write two tests - the first one to check if the button exists and the second to check if it works properly and shows the message.</p>
<p>Now, let’s make sure that in the beginning, Cypress will open the application. To achieve that, add <code>beforeEach</code> statement at the beginning:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/message.spec.js</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Show message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button exists"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button shows the message'"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Now before each test (each <code>it</code>) Cypress will go to the application root URL. Note that you don’t need to provide the full address - it is already preconfigured and you don’t need to worry about it.</p>
</div>
<div class="section level3">
<h3 id="test-if-the-button-exists">Test if the button exists<a class="anchor" aria-label="anchor" href="#test-if-the-button-exists"></a>
</h3>
<p>The test is going to use two Cypress commands - <code>get</code> and <code>should</code>. The first one will look for an element using a given CSS selector and the second will check if the selected element has the expected property.</p>
<p>First, we need to build a CSS selector that will point Cypress to the correct button. This can be done using the part of the browser Developer Tools, usually called (depending on which browser you use) Inspector, Explorer, or Elements. You can learn more about Developer Tools available in your browser for example from <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_are_browser_developer_tools" class="external-link">this article</a>.</p>
<p>Now, run the application (<code><a href="https://rdrr.io/pkg/shiny/man/runApp.html" class="external-link">shiny::runApp()</a></code> in the R console or a button in RStudio), open it in the browser, right-click on the “Show message” button, and select Inspect. Now you should be able to see the HTML structure of the webpage with the button highlighted. From this view, you can see that we can ask for example for a <code>button</code> (HTML tag) inside an element of class <code>message</code>. Let’s pass this selector to Cypress <code>get</code> command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/message.spec.js</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Show message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button exists"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".message button"</span>)<span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button shows the message'"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>The next step is to check if this button has a proper label:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/message.spec.js</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Show message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button exists"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".message button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Show message"</span>)<span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button shows the message'"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>If you run tests (<code><a href="../../reference/test_e2e.html">rhino::test_e2e()</a></code>), you will see that it passes - the button is there:</p>
<p><img src="images/message_e2e_test_1.png"></p>
</div>
<div class="section level3">
<h3 id="test-if-the-button-shows-the-message">Test if the button shows the message<a class="anchor" aria-label="anchor" href="#test-if-the-button-shows-the-message"></a>
</h3>
<p>Ok, we are sure that the button exists, now it’s time to click it and check the outcome. Cypress comes with a command called <code>click</code> (who would expect that?!). Use it in the second test to click the button:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/message.spec.js</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Show message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button exists"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".message button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Show message"</span>)<span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button shows the message'"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".message button"</span>)<span class="op">.</span><span class="fu">click</span>()<span class="op">;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Now, we just need to check if the message is there and has proper content. We will do it the same as we did with the button - we will look for it using the CSS selector and check if it contains the expected text. This time we will use the id. If you check the element in the browser (the same way as we did with the button), you will see that the id of the message is “app-message-message_text”. This shows, that in Rhino, everything is a Shiny module, even the outermost UI and server part. “app” in this selector is the namespace that identifies this outer module. “message” is the namespace part added when we called our <code>message.R</code> module and “message_text” is the id of our <code>textOutput</code>.</p>
<p>Ok, let’s use it and check if the message element has a correct text inside:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/message.spec.js</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Show message"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button exists"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".message button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Show message"</span>)<span class="op">;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"'Show message' button shows the message'"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".message button"</span>)<span class="op">.</span><span class="fu">click</span>()<span class="op">;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">"#app-message-message_text"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"This is a message"</span>)<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Run tests again and you should see that again, all passed:</p>
<p><img src="images/message_e2e_test_2.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="test-counting-clicks-functionality">Test counting clicks functionality<a class="anchor" aria-label="anchor" href="#test-counting-clicks-functionality"></a>
</h2>
<p>As previously, we need to start with creating a file and providing the test structure. Create <code>tests/cypress/integration/clicks.spec.js</code> and fill it with the skeleton similar to the first test file:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/clicks.spec.js</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Counting clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"has a 'Click me!' button"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"counts clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<div class="section level3">
<h3 id="test-if-the-button-exists-1">Test if the button exists<a class="anchor" aria-label="anchor" href="#test-if-the-button-exists-1"></a>
</h3>
<p>First, we want to make sure the button exists. We will follow the example from the message module:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/clicks.spec.js</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Counting clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"has a 'Click me!' button"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Click me!"</span>)<span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"counts clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Now, if you run tests, you will see the new ones. And they should pass.</p>
<p><img src="images/clicks_e2e_test_1.png"></p>
</div>
<div class="section level3">
<h3 id="test-if-clicks-are-counted-correctly">Test if clicks are counted correctly<a class="anchor" aria-label="anchor" href="#test-if-clicks-are-counted-correctly"></a>
</h3>
<p>The next step is to check if clicking the button affects the counter and if it shows the correct value. To do that, we will simulate 5 clicks and check if the counter is set to 5.</p>
<p>Since the button will be clicked several times, we will use an <a href="https://docs.cypress.io/guides/core-concepts/variables-and-aliases#Aliases" class="external-link">alias</a>. To do that, we will utilize another Cypress command: <code>as</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/clicks.spec.js</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Counting clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"has a 'Click me!' button"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Click me!"</span>)<span class="op">;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"counts clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">as</span>(<span class="st">"button"</span>)<span class="op">;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Now, we can access the button using <code>@button</code>. So let’s click it 5 times:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/clicks.spec.js</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Counting clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"has a 'Click me!' button"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Click me!"</span>)<span class="op">;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"counts clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">as</span>(<span class="st">"button"</span>)<span class="op">;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>      cy<span class="op">.</span><span class="fu">get</span>(<span class="st">"@button"</span>)<span class="op">.</span><span class="fu">click</span>()<span class="op">;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a>    }</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Finally, we need to check if the counter has the correct value (you already know how to look for its id to pass to <code>get</code> command):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co">// tests/cypress/integration/clicks.spec.js</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">"Counting clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">visit</span>(<span class="st">"/"</span>)<span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"has a 'Click me!' button"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"Click me!"</span>)<span class="op">;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">"counts clicks"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">".clicks button"</span>)<span class="op">.</span><span class="fu">as</span>(<span class="st">"button"</span>)<span class="op">;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true"></a>      cy<span class="op">.</span><span class="fu">get</span>(<span class="st">"@button"</span>)<span class="op">.</span><span class="fu">click</span>()<span class="op">;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true"></a>    }</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true"></a>    cy<span class="op">.</span><span class="fu">get</span>(<span class="st">"#app-clicks-counter"</span>)<span class="op">.</span><span class="fu">should</span>(<span class="st">"have.text"</span><span class="op">,</span> <span class="st">"5"</span>)<span class="op">;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>Now, run your tests. You should see something similar to this (you might have noticed that now clicking test took more time than previously - that’s because the clicking finally happened):</p>
<p><img src="images/clicks_e2e_test_2.png"></p>
<p>If you run tests using the interactive mode (<code>rhino::test_e2e(interactive = TRUE)</code>), you will be able to check each click as a separate action!</p>
<p><img src="images/interactive_e2e_test.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="what-happens-when-the-app-changes">What happens when the app changes?<a class="anchor" aria-label="anchor" href="#what-happens-when-the-app-changes"></a>
</h2>
<p>Let’s now think about a scenario, when, during the development of the application some new feature has been introduced. This feature works fine, but unfortunately, it added some unexpected changes to other features.</p>
<p>We will simulate this by a small modification in the <code>app/view/clicks.R</code> - we will add 1 to the counter:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># app/view/clicks.R</span></span>
<span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span><span class="va">actionButton</span>, <span class="va">div</span>, <span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderText</span>, <span class="va">textOutput</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu">div</span><span class="op">(</span></span>
<span>    class <span class="op">=</span> <span class="st">"clicks"</span>,</span>
<span>    <span class="fu">actionButton</span><span class="op">(</span></span>
<span>      <span class="fu">ns</span><span class="op">(</span><span class="st">"click"</span><span class="op">)</span>,</span>
<span>      <span class="st">"Click me!"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu">textOutput</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"counter"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">counter</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">click</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>If you now run tests, you will see that the counting one failed:</p>
<p><img src="images/failing_e2e_test.png"></p>
<p>This way we spotted the (unexpected) change in the application behavior in an automated way. Without end-to-end tests, this could go unnoticed, since the app still works - there are no errors, it is just the logic that has been changed in a way we didn’t want it to be modified.</p>
</div>
<div class="section level2">
<h2 id="continuous-integration">Continuous Integration<a class="anchor" aria-label="anchor" href="#continuous-integration"></a>
</h2>
<p>But here comes a question: <strong>Do you need to run those tests each time you make a change?</strong></p>
<p>Fortunately, this can be automated! Rhino comes with a setup for <a href="https://github.com/features/actions" class="external-link">GitHub Actions</a> will run those tests for you and inform you if there is a problem. You can even block merging changes that don’t pass those automated checks.</p>
<p>What do you need to do to get all of this? If you are using GitHub - literally nothing! Your Rhino application comes with a GitHub Actions configuration (<code>.github/workflows/rhino-test.yml</code>) that includes end-to-end tests!</p>
<p><img src="images/e2e_in_CI.png"></p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Adding end-to-end tests to your application can ensure the quality and help catch bugs early in the process of development. Rhino comes with a powerful setup that utilizes <a href="https://www.cypress.io/" class="external-link">Cypress</a> to check the behavior of your application.</p>
<p>But what if you want to use another solution: <code>shinytest2</code>?</p>
<p>You can do that without any problems, <code>shinytest2</code> works out of the box in Rhino applications! You can learn more <a href="https://appsilon.github.io/rhino/articles/how-to/use-shinytest2.html">here</a>.</p>
<p>And if you want to learn about the differences between Cypress and <code>shinytest2</code>, check <a href="https://appsilon.com/shinytest2-vs-cypress-e2e-testing/" class="external-link">this blogpost</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kamil Żyła, Jakub Nowicki, Leszek Siemiński, Marek Rogala, Recle Vibal, Tymoteusz Makowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
