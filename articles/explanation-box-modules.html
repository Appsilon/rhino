<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explanation: Box modules • rhino</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Explanation: Box modules">
<meta property="og:description" content="rhino">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-DL2H66RTY1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DL2H66RTY1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rhino</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/tutorial-create-your-first-rhino-app.html">Tutorial</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Explanation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/explanation-application-structure.html">Application structure</a>
    </li>
    <li>
      <a href="../articles/explanation-box-modules.html">Box modules</a>
    </li>
    <li>
      <a href="../articles/explanation-renv-configuration.html">Renv configuration</a>
    </li>
    <li>
      <a href="../articles/explanation-node-js-javascript-and-sass-tools.html">Node.js - JavaScript and Sass tools</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    How-to Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/how-to-migrate-app-to-rhino.html">Migrate app to Rhino</a>
    </li>
    <li>
      <a href="../articles/how-to-write-r-code.html">Write R code</a>
    </li>
    <li>
      <a href="../articles/how-to-write-javascript-code.html">Write JavaScript code</a>
    </li>
    <li>
      <a href="../articles/how-to-use-static-files.html">Use static files</a>
    </li>
    <li>
      <a href="../articles/how-to-manage-r-dependencies.html">Manage R dependencies</a>
    </li>
    <li>
      <a href="../articles/how-to-keep-multiple-apps-in-a-single-repository.html">Keep multiple apps in a single repository</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Appsilon/rhino/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Explanation: Box modules</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Appsilon/rhino/blob/HEAD/vignettes/explanation-box-modules.Rmd" class="external-link"><code>vignettes/explanation-box-modules.Rmd</code></a></small>
      <div class="hidden name"><code>explanation-box-modules.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="rationale">Rationale<a class="anchor" aria-label="anchor" href="#rationale"></a>
</h2>
<p>With large applications it is critical for maintainability to properly structure your code using files and directories. R comes with the <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> and <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> functions, but its functionality is limited when it comes to dividing your code into modules and expressing their dependencies.</p>
<p>To address this, Rhino uses the <a href="https://klmr.me/box/" class="external-link">box</a> R package, which allows you to modularize your code in a similar way to languages like Python and Java:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>
  <span class="va">dplyr</span>, <span class="co"># Import dplyr. Its functions can be used via `$`, e.g. `dplyr$filter`.</span>
  <span class="va">shiny</span><span class="op">[</span><span class="va">reactive</span><span class="op">]</span>, <span class="co"># Import the `reactive()` function from shiny package.</span>
<span class="op">)</span>
<span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>
  <span class="va">logic</span><span class="op">/</span><span class="va">data_validation</span>, <span class="co"># Import the `logic/data_validation.R` module.</span>
<span class="op">)</span></code></pre></div>
<p>Box modules force you to be explicit about the dependencies between your files and packages. The graph of dependencies is visible at a glance in an app developed with box, while the traditional approach (<code>global.R</code>, <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code>, <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code>) makes it easy to build an app which only the author understands. Introduction of box to existing apps written without it has helped to improve the code structure and find bugs.</p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<p>The best place to learn about box is its official <a href="https://klmr.me/box/" class="external-link">documentation</a>. Some useful box features are also explained in the sections below.</p>
<div class="section level3">
<h3 id="init-files">Init files<a class="anchor" aria-label="anchor" href="#init-files"></a>
</h3>
<p>Objects exported by an <code>__init__.R</code> file can be imported from its parent directory.</p>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>Assume we have an <code>app/foo/__init__.R</code> file with the following content:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="va">bar</span> <span class="op">&lt;-</span> <span class="st">"Hello!"</span></code></pre></div>
<p>We can now import <code>bar</code> as if it was defined in <code>app/foo.R</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>
  <span class="va">app</span><span class="op">/</span><span class="va">foo</span><span class="op">[</span><span class="va">bar</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<p>This mechanism can be used in combination with reexports to make it easier to import multiple modules from a single directory.</p>
</div>
</div>
<div class="section level3">
<h3 id="reexports">Reexports<a class="anchor" aria-label="anchor" href="#reexports"></a>
</h3>
<p>A module can reexport objects imported from a different module by applying <code>#' @export</code> to a <code><a href="http://klmr.me/box/reference/use.html" class="external-link">box::use()</a></code> statement.</p>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>Assume we have modules <code>analysis_tab.R</code> and <code>download_tab.R</code> in the <code>app/view</code> directory. We can reexport them from <code>app/view/__init__.R</code> like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#' @export</span>
<span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>
  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">/</span><span class="va">analysis_tab</span>,
  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">/</span><span class="va">download_tab</span>
<span class="op">)</span></code></pre></div>
<p>The following <code><a href="http://klmr.me/box/reference/use.html" class="external-link">box::use()</a></code> statements are now equivalent:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>
  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">/</span><span class="va">analysis_tab</span>,
  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">/</span><span class="va">download_tab</span>,
<span class="op">)</span>
<span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>
  <span class="va">app</span><span class="op">/</span><span class="va">view</span><span class="op">[</span><span class="va">analysis_tab</span>, <span class="va">download_tab</span><span class="op">]</span>,
<span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="known-issues">Known issues<a class="anchor" aria-label="anchor" href="#known-issues"></a>
</h2>
<div class="section level4">
<h4 id="lazy-loaded-data">Lazy-loaded data<a class="anchor" aria-label="anchor" href="#lazy-loaded-data"></a>
</h4>
<p>Box 1.1.0 doesn’t support lazy-loaded <a href="https://r-pkgs.org/data.html#data-data" class="external-link">data</a>, so e.g. <code>box::use(datasets[mtcars])</code> won’t work. This feature should be available in the next release (see this <a href="https://github.com/klmr/box/issues/219" class="external-link">issue</a>). For now please use <code><a href="https://rdrr.io/r/datasets/mtcars.html" class="external-link">datasets::mtcars</a></code> in your code.</p>
</div>
<div class="section level4">
<h4 id="trailing-commas">Trailing commas<a class="anchor" aria-label="anchor" href="#trailing-commas"></a>
</h4>
<p>Box 1.1.0 allows trailing commas in <code><a href="http://klmr.me/box/reference/use.html" class="external-link">box::use()</a></code> statements and code, but they can cause problems in some circumstances:</p>
<ol style="list-style-type: decimal">
<li>Reexports (<a href="https://github.com/klmr/box/issues/263" class="external-link">issue</a>).</li>
<li>Functions accessed via <code>$</code> (<a href="https://github.com/klmr/box/issues/266" class="external-link">issue</a>).</li>
</ol>
<p>Both issues should be fixed in the nearest release.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kamil Zyla, Jakub Nowicki, Tymoteusz Makowski, Marek Rogala.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
