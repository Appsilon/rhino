<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Explanation: Application structure • rhino</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Explanation: Application structure">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-NEHZJ9B11D"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NEHZJ9B11D');
</script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-FQQZL5V93G"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-FQQZL5V93G');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">rhino</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>

    <div id="version-switcher" class="dropdown">
  <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">1.5</a>
  <ul class="dropdown-menu">
<li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/dev">1.11.0.9000 (dev)</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/">1.11</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.10.1">1.10</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.9.0">1.9</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.8.0">1.8</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.7.0">1.7</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.6.0">1.6</a>
    </li>
    <li>
      <a class="dropdown-item" href="https://appsilon.github.io/rhino/v1.5.0">1.5</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.4.0">1.4</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.3.1">1.3</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.2.1">1.2</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.1.1">1.1</a>
    </li>
    <li>
      <a class="external-link dropdown-item" href="https://appsilon.github.io/rhino/v1.0.0">1.0</a>
    </li>
  </ul>
</div>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../../articles/tutorial/create-your-first-rhino-app.html">Create your first Rhino app</a></li>
    <li><a class="dropdown-item" href="../../articles/tutorial/write-end-to-end-tests-with-cypress.html">Write end-to-end tests with Cypress</a></li>
    <li><a class="dropdown-item" href="../../articles/tutorial/use-react-in-rhino.html">Use React in Rhino</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-explanation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Explanation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-explanation">
<li><a class="dropdown-item" href="../../articles/explanation/what-is-rhino.html">What is Rhino?</a></li>
    <li><a class="dropdown-item" href="../../articles/explanation/application-structure.html">Application structure</a></li>
    <li><a class="dropdown-item" href="../../articles/explanation/rhino-yml.html">Configuring Rhino - rhino.yml</a></li>
    <li><a class="dropdown-item" href="../../articles/explanation/box-modules.html">Box modules</a></li>
    <li><a class="dropdown-item" href="../../articles/explanation/renv-configuration.html">Renv configuration</a></li>
    <li><a class="dropdown-item" href="../../articles/explanation/node-js-javascript-and-sass-tools.html">Node.js - JavaScript and Sass tools</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How-to Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to-guides">
<li><a class="dropdown-item" href="../../articles/how-to/migrate-app-to-rhino.html">Migrate app to Rhino</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/write-r-code.html">Write R code</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/write-javascript-code.html">Write JavaScript code</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-static-files.html">Use static files</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/manage-secrets-and-environments.html">Manage secrets and environments</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/enable-shiny-bookmarking.html">Enable Shiny bookmarking</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/keep-multiple-apps-in-a-single-repository.html">Keep multiple apps in a single repository</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-global-variables.html">Use global variables</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-shinytest2.html">Use shinytest2</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/add-internationalization.html">Add internationalization</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/add-routing.html">Add routing</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/set-application-run-parameters.html">Set application run parameters</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-addins.html">Use Rhino Addin(s)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>UI</h6></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-shiny-fluent.html">Use shiny.fluent</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Authentication</h6></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-shinymanager.html">Use shinymanager</a></li>
    <li><a class="dropdown-item" href="../../articles/how-to/use-polished.html">Use polished</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Deployment</h6></li>
    <li><a class="dropdown-item" href="../../articles/how-to/publish-on-huggingface.html">Publish on Hugging Face</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../../articles/faq.html">FAQ</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Appsilon/rhino/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/Appsilon"><span class="fa fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://fosstodon.org/@appsilon"><span class="fa fab fa-mastodon fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Explanation: Application structure</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Appsilon/rhino/blob/main/vignettes/explanation/application-structure.Rmd" class="external-link"><code>vignettes/explanation/application-structure.Rmd</code></a></small>
      <div class="d-none name"><code>application-structure.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a>
</h2>
<p>Shiny comes with a powerful <a href="https://shiny.rstudio.com/articles/reactivity-overview.html" class="external-link">reactive
programming</a> model and a rich set of functions for creating UI
widgets or custom <a href="https://shiny.rstudio.com/articles/tag-glossary.html" class="external-link">HTML
structure</a>. These features make it possible to quickly build
impressive, interactive applications, but they can also make it harder
to test and reuse your code.</p>
<p>To address this issue, we recommend separating the code that depends
on Shiny from the logic which can be expressed without it. In our
experience, this division is crucial for building robust and
maintainable applications. To support this separation, Rhino encourages
a specific structure for the R sources of your application:</p>
<ul>
<li>
<code>main.R</code>: The entry point to your application.</li>
<li>
<code>logic</code>: Application code independent from Shiny.</li>
<li>
<code>view</code>: Shiny modules and related code.</li>
</ul>
<div class="section level3">
<h3 id="logic">Logic<a class="anchor" aria-label="anchor" href="#logic"></a>
</h3>
<p>Use the <code>logic</code> directory for code which can be expressed
without Shiny.</p>
<p>Every Shiny app may have a different end goal, but they all generally
contain isolatable sections of code that can expressed as a normal R
functions. This could be data manipulation, generating non-interactive
plots and graphs, or connecting to an external data source, but outside
of definable inputs, it doesn’t interact with or rely on Shiny in any
way.</p>
<p>Code that relies upon reactivity or UI builder/markup functions can
be problematic to test and difficult to reuse. With proper design and
understanding of this concept, it is possible to express most of your
application logic using plain R functions and data structures (like
lists, data frames).</p>
</div>
<div class="section level3">
<h3 id="view">View<a class="anchor" aria-label="anchor" href="#view"></a>
</h3>
<p>The <code>view</code> directory should contain code which describes
the user interface of your application and relies upon the reactive
capabilities of Shiny. Here is where we will use the functions defined
in <code>logic</code>, and where the core app functionality will be
defined.</p>
<p>If you are not familiar with <a href="https://shiny.rstudio.com/articles/modules.html" class="external-link">Shiny
modules</a>, please take the time to read up on the concept. In short,
using modules we can isolate paired Shiny UI/Server code, and we prevent
overlap of reactivity by wrapping all input/output value names with the
<code>ns()</code> function. This allows us to “namespace” the running
module and use it multiple times in the same application. This is a very
important concept to shortly summarize, but if this is new to you just
remember that if you want to reference a UI element in the server, it
needs to be namespaced.</p>
<p>A typical module could be structured like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">shiny</span><span class="op">[</span><span class="va">moduleServer</span>, <span class="va">NS</span>, <span class="va">renderText</span>, <span class="va">tagList</span>, <span class="va">textInput</span>, <span class="va">textOutput</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span></span>
<span>  <span class="va">app</span><span class="op">/</span><span class="va">logic</span><span class="op">/</span><span class="va">messages</span><span class="op">[</span><span class="va">hello_message</span><span class="op">]</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu">NS</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu">tagList</span><span class="op">(</span></span>
<span>    <span class="fu">textInput</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"name"</span><span class="op">)</span>, <span class="st">"Name"</span><span class="op">)</span>,</span>
<span>    <span class="fu">textOutput</span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"message"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">moduleServer</span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">message</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="fu">hello_message</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="minimal-app-r">Minimal <code>app.R</code><a class="anchor" aria-label="anchor" href="#minimal-app-r"></a>
</h2>
<p>A Rhino application comes with a minimal <code>app.R</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rhino / shinyApp entrypoint. Do not edit.</span></span>
<span><span class="fu">rhino</span><span class="fu">::</span><span class="fu"><a href="../../reference/app.html">app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>It is important that you do not edit this file or use it like a
<code>global.R</code> file, and instead write your top-level code in
<code>app/main.R</code>. It is also important to note that thanks to the
<code>shinyApp</code> string in the comment, RStudio recognizes this
file as a Shiny application and displays the “Run” and “Publish”
buttons.</p>
<p>This approach gives Rhino full control over the startup processes of
your application. Steps performed by <code><a href="../../reference/app.html">rhino::app()</a></code>
include:</p>
<ol style="list-style-type: decimal">
<li>Purge box cache, so the app can be reloaded without restarting R
session.</li>
<li>Configure logger (log level, log file).</li>
<li>Configure static files.</li>
<li>Load the main module / legacy entrypoint.</li>
<li>Add head tags (favicon, CSS &amp; JS).</li>
</ol>
<p>It is a fair question to ask if we really need a separate
<code>main.R</code> file. Couldn’t we just define the top-level
<code>ui</code> and <code>server</code> in <code>app.R</code> and pass
it to <code><a href="../../reference/app.html">rhino::app()</a></code> as arguments as we would with a normal
<code>shiny::shinyApp() call</code>?</p>
<p>The reasoning behind this structure is to enforce consistent use of
the <a href="https://klmr.me/box/" class="external-link">box</a> modules throughout the application. A file loaded
with <code><a href="http://klmr.me/box/reference/use.html" class="external-link">box::use()</a></code> can only load other modules/packages with
<code><a href="http://klmr.me/box/reference/use.html" class="external-link">box::use()</a></code>. In short, this means that we cannot use the
<code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> or <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code> functions in our app.
This is an important distinction from traditional Shiny structure, where
we are simply sourcing <code>app.R</code> when the app is loaded.</p>
<p>As the entire Rhino application is loaded with
<code>box::use(app/main)</code>, all its sources must be properly
structured as box modules.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kamil Żyła, Jakub Nowicki, Leszek Siemiński, Marek Rogala, Recle Vibal, Tymoteusz Makowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
